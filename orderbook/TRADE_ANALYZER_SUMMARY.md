# æœŸè´§äº¤æ˜“æ•°æ®åˆ†æç¨‹åºæ€»ç»“

## é¡¹ç›®æ¦‚è¿°

åŸºäºæ‚¨çš„éœ€æ±‚ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„æœŸè´§äº¤æ˜“æ•°æ®åˆ†æç¨‹åºï¼Œç”¨äºåˆ†æBinanceæœŸè´§äº¤æ˜“æ•°æ®å¹¶è°ƒç”¨æœ¬åœ°Order Book APIæ¥è·å–äº¤æ˜“å‰åçš„æŒ‚å•æ•°é‡å˜åŒ–ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. å®æ—¶æ•°æ®æ¥æ”¶
- é€šè¿‡WebSocketè¿æ¥BinanceæœŸè´§èšåˆäº¤æ˜“æ•°æ®æµ
- æ”¯æŒETHUSDTç­‰æœŸè´§äº¤æ˜“å¯¹
- å®æ—¶æ¥æ”¶äº¤æ˜“äº‹ä»¶å’Œäº¤æ˜“æ—¶é—´æ•°æ®

### 2. äº¤æ˜“åˆ†æ
- åˆ†æäº¤æ˜“å‰åçš„Order Bookå˜åŒ–
- è®¡ç®—æŒ‚å•æ•°é‡å·®å€¼
- åˆ¤æ–­äº¤æ˜“ç±»å‹ï¼ˆä¸»åŠ¨ä¹°å…¥/å–å‡ºï¼‰
- è¯†åˆ«æŒ‚å•å¢åŠ æˆ–å‡å°‘çš„æƒ…å†µ

### 3. APIé›†æˆ
- è°ƒç”¨æœ¬åœ°Order Book APIè·å–å†å²æ•°æ®
- æ”¯æŒäº‹ä»¶æ—¶é—´å’Œäº¤æ˜“æ—¶é—´åˆ†æ
- è·å–æŒ‡å®šä»·æ ¼å’Œæ—¶é—´ç‚¹çš„æŒ‚å•ä¿¡æ¯

### 4. å¯è§†åŒ–è¾“å‡º
- å½©è‰²ç»ˆç«¯è¾“å‡º
- è¯¦ç»†çš„åˆ†æç»“æœå±•ç¤º
- å®æ—¶ç»Ÿè®¡ä¿¡æ¯
- é”™è¯¯å’Œè­¦å‘Šæç¤º

## æ–‡ä»¶ç»“æ„

```
orderbook/
â”œâ”€â”€ future_trade_analyzer.py      # ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ trade_analyzer_config.py      # é…ç½®æ–‡ä»¶
â”œâ”€â”€ start_trade_analyzer.sh       # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test_trade_analyzer.py        # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ TRADE_ANALYZER_README.md      # ä½¿ç”¨è¯´æ˜
â””â”€â”€ TRADE_ANALYZER_SUMMARY.md     # æ€»ç»“æ–‡æ¡£
```

## æŠ€æœ¯å®ç°

### 1. æ•°æ®æµç¨‹
```
Binance WebSocket â†’ äº¤æ˜“æ•°æ®æ¥æ”¶ â†’ æ•°æ®è¿‡æ»¤ â†’ APIè°ƒç”¨ â†’ åˆ†æè®¡ç®— â†’ ç»“æœå±•ç¤º
```

### 2. å…³é”®ç»„ä»¶

#### TradeAnalyzerç±»
- ç®¡ç†HTTPä¼šè¯å’ŒAPIè°ƒç”¨
- å¤„ç†äº¤æ˜“æ¶ˆæ¯å’Œåˆ†æ
- ç¼“å†²åŒºç®¡ç†å’Œç»Ÿè®¡åˆ†æ

#### é…ç½®ç®¡ç†
- å¯é…ç½®çš„åˆ†æå‚æ•°
- çµæ´»çš„APIè®¾ç½®
- å¯è°ƒæ•´çš„æ˜¾ç¤ºé€‰é¡¹

#### WebSocketå¤„ç†
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- é”™è¯¯å¤„ç†å’Œæ¢å¤
- æ¶ˆæ¯è§£æå’ŒéªŒè¯

### 3. åˆ†æé€»è¾‘

#### äº¤æ˜“ç±»å‹åˆ¤æ–­
```python
# m: true â†’ ä¸»åŠ¨å–å‡ºï¼ˆä¹°æ–¹ä¸ºåšå¸‚å•†ï¼‰
# m: false â†’ ä¸»åŠ¨ä¹°å…¥ï¼ˆå–æ–¹ä¸ºåšå¸‚å•†ï¼‰
if is_buyer_maker:
    trade_type = "ä¸»åŠ¨å–å‡º"
else:
    trade_type = "ä¸»åŠ¨ä¹°å…¥"
```

#### æŒ‚å•å˜åŒ–åˆ†æ
```python
# è·å–äº¤æ˜“å‰åçš„æ•°æ®
before_data = await get_orderbook_at_time(price, trade_time_sec - 1)
after_data = await get_orderbook_at_time(price, trade_time_sec + 1)

# è®¡ç®—å˜åŒ–
qty_change = after_qty - before_qty
if qty_change > 0:
    result = "æŒ‚å•å¢åŠ : å¯èƒ½æœ‰æ–°è®¢å•è¿›å…¥"
elif qty_change < 0:
    result = "æŒ‚å•å‡å°‘: è®¢å•è¢«æ¶ˆè€—"
else:
    result = "æŒ‚å•æ— æ˜æ˜¾å˜åŒ–"
```

## ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨æœ¬åœ°Order Bookç³»ç»Ÿ
```bash
./start_simple.sh
```

### 2. å¯åŠ¨äº¤æ˜“åˆ†æç¨‹åº
```bash
./start_trade_analyzer.sh
```

### 3. è¿è¡Œæµ‹è¯•
```bash
python3 test_trade_analyzer.py
```

## é…ç½®é€‰é¡¹

### ä¸»è¦é…ç½®å‚æ•°
```python
# APIé…ç½®
LOCAL_API_BASE_URL = "http://localhost:8000"
WEBSOCKET_URL = "wss://fstream.binance.com/ws/ETHUSDT@aggTrade"
SYMBOL = "ETHUSDT"

# åˆ†æé…ç½®
MIN_QUANTITY_THRESHOLD = 1.0  # æœ€å°äº¤æ˜“æ•°é‡é˜ˆå€¼
ANALYSIS_WINDOW_SECONDS = 5   # åˆ†ææ—¶é—´çª—å£
PRICE_TOLERANCE = 0.1         # ä»·æ ¼å®¹å·®

# æ€§èƒ½é…ç½®
BUFFER_SIZE = 100             # ç¼“å†²åŒºå¤§å°
ANALYSIS_INTERVAL = 1.0       # åˆ†æé—´éš”
API_TIMEOUT = 5               # APIè¶…æ—¶æ—¶é—´
```

## è¾“å‡ºç¤ºä¾‹

### åˆ†æç»“æœ
```
============================================================
äº¤æ˜“åˆ†æç»“æœ
============================================================
äº¤æ˜“ä¿¡æ¯:
  æ—¶é—´: 18:30:15.123 (äº‹ä»¶) / 18:30:15.120 (äº¤æ˜“)
  ä»·æ ¼: $50000.00
  æ•°é‡: 1.5000 ETHUSDT
  ç±»å‹: ä¸»åŠ¨ä¹°å…¥

Order Bookå˜åŒ–:
  äº¤æ˜“å‰: ä»·æ ¼=$50000.00, æŒ‚å•é‡=10.500000
  äº¤æ˜“å: ä»·æ ¼=$50000.00, æŒ‚å•é‡=9.000000
  å˜åŒ–é‡: -1.500000
  æŒ‚å•å‡å°‘: è®¢å•è¢«æ¶ˆè€—
============================================================
```

### ç»Ÿè®¡ä¿¡æ¯
```
ç»Ÿè®¡ä¿¡æ¯:
  æ€»äº¤æ˜“æ•°: 1250
  å·²åˆ†æäº¤æ˜“: 45
  APIè°ƒç”¨æ¬¡æ•°: 90
  é”™è¯¯æ¬¡æ•°: 2
  ç¼“å†²åŒºå¤§å°: 0
========================================
```

## æµ‹è¯•ç»“æœ

è¿è¡Œæµ‹è¯•è„šæœ¬çš„ç»“æœï¼š
```
=== æµ‹è¯•ç»“æœ ===
é€šè¿‡: 4/4
æˆåŠŸç‡: 100.0%
ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œã€‚
```

## ä¼˜åŠ¿ç‰¹ç‚¹

### 1. å®æ—¶æ€§
- æ¯«ç§’çº§æ•°æ®æ¥æ”¶
- å®æ—¶åˆ†æå’Œå±•ç¤º
- ä½å»¶è¿ŸAPIè°ƒç”¨

### 2. å¯é æ€§
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- é”™è¯¯å¤„ç†å’Œæ¢å¤
- è¶…æ—¶ä¿æŠ¤

### 3. å¯é…ç½®æ€§
- çµæ´»çš„é…ç½®å‚æ•°
- å¯è°ƒæ•´çš„åˆ†æé˜ˆå€¼
- å¯è‡ªå®šä¹‰çš„æ˜¾ç¤ºé€‰é¡¹

### 4. å¯æ‰©å±•æ€§
- æ¨¡å—åŒ–è®¾è®¡
- æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
- æ”¯æŒå¤šäº¤æ˜“å¯¹

## æ€§èƒ½ä¼˜åŒ–

### 1. å†…å­˜ç®¡ç†
- é™åˆ¶ç¼“å†²åŒºå¤§å°
- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
- ä¼˜åŒ–æ•°æ®ç»“æ„

### 2. APIè°ƒç”¨ä¼˜åŒ–
- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
- æ‰¹é‡å¤„ç†è¯·æ±‚
- é”™è¯¯é‡è¯•æœºåˆ¶

### 3. ç½‘ç»œä¼˜åŒ–
- WebSocketè¿æ¥å¤ç”¨
- è‡ªåŠ¨é‡è¿å’Œæ¢å¤
- è¿æ¥çŠ¶æ€ç›‘æ§

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æœ¬åœ°APIè¿æ¥å¤±è´¥**: ç¡®ä¿localorderbok.pyæ­£åœ¨è¿è¡Œ
2. **WebSocketè¿æ¥æ–­å¼€**: ç¨‹åºä¼šè‡ªåŠ¨é‡è¿
3. **APIè°ƒç”¨è¶…æ—¶**: æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæœ¬åœ°APIçŠ¶æ€
4. **æ•°æ®è§£æé”™è¯¯**: æ£€æŸ¥Binance APIçŠ¶æ€

### è§£å†³æ–¹æ¡ˆ
- æŸ¥çœ‹è¯¦ç»†æ—¥å¿—è¾“å‡º
- è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯
- æ£€æŸ¥é…ç½®æ–‡ä»¶è®¾ç½®
- ç¡®è®¤ä¾èµ–åŒ…å®‰è£…

## æ‰©å±•å»ºè®®

### 1. æ•°æ®å­˜å‚¨
- æ·»åŠ æ•°æ®åº“æ”¯æŒ
- ä¿å­˜åˆ†æç»“æœ
- å†å²æ•°æ®æŸ¥è¯¢

### 2. å‘Šè­¦åŠŸèƒ½
- ä»·æ ¼å¼‚å¸¸å‘Šè­¦
- å¤§å•æ£€æµ‹å‘Šè­¦
- è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™

### 3. å¤šäº¤æ˜“å¯¹æ”¯æŒ
- åŒæ—¶ç›‘æ§å¤šä¸ªäº¤æ˜“å¯¹
- è·¨äº¤æ˜“å¯¹åˆ†æ
- ç›¸å…³æ€§åˆ†æ

### 4. å¯è§†åŒ–ç•Œé¢
- Webç•Œé¢å±•ç¤º
- å›¾è¡¨å’Œè¶‹åŠ¿åˆ†æ
- å®æ—¶æ•°æ®å±•ç¤º

## æ€»ç»“

è¿™ä¸ªæœŸè´§äº¤æ˜“æ•°æ®åˆ†æç¨‹åºå®Œå…¨æ»¡è¶³æ‚¨çš„éœ€æ±‚ï¼š

1. âœ… **å®æ—¶è·å–æœŸè´§äº¤æ˜“æ•°æ®**: é€šè¿‡WebSocketæ¥æ”¶BinanceæœŸè´§èšåˆäº¤æ˜“æ•°æ®
2. âœ… **äº‹ä»¶æ—¶é—´å’Œäº¤æ˜“æ—¶é—´åˆ†æ**: æ”¯æŒä¸¤ç§æ—¶é—´æˆ³çš„åˆ†æ
3. âœ… **è°ƒç”¨æœ¬åœ°Order Book API**: é›†æˆæœ¬åœ°APIè·å–å†å²æ•°æ®
4. âœ… **åˆ†ææŒ‚å•æ•°é‡å˜åŒ–**: è®¡ç®—äº¤æ˜“å‰åçš„æŒ‚å•å·®å€¼
5. âœ… **å¯è§†åŒ–å±•ç¤º**: å½©è‰²ç»ˆç«¯è¾“å‡ºå’Œè¯¦ç»†åˆ†æç»“æœ

ç¨‹åºå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ã€å¯é æ€§å’Œæ˜“ç”¨æ€§ï¼Œå¯ä»¥æ»¡è¶³æœŸè´§äº¤æ˜“æ•°æ®åˆ†æçš„å„ç§éœ€æ±‚ã€‚ 